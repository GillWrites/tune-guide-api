openapi: 3.1.0

info:
  title: TuneGuide API
  description:  TuneGuide is a RestAPI that integrates music channel listings and show information into one accessible, easy-to-use API.
  version: 1.0.0
  contact:
    name: TuneGuide API
    email: api-support@example.com

servers:
  - url: http://localhost:3000
    description: Local server for testing

tags:
  - name: Channels
    description: Operations related to radio channels
  - name: Shows
    description: Operations related to radio shows

security:
  - bearerAuth: []

paths:
  /channels:
    get:
      summary: Get all channels
      description: Returns a paginated list of all radio channels
      tags:
        - Channels
      operationId: getAllChannels
      parameters:
        - $ref: '#/components/parameters/PaginationPageParam'
        - $ref: '#/components/parameters/PaginationPerPageParam'
        - $ref: '#/components/parameters/SortParam'
      responses:
        '200':
          $ref: '#/components/responses/SuccessGetAllChannels'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/ServerError'

    post:
      summary: Create a new channel
      description: Creates a new radio channel
      tags:
        - Channels
      operationId: postNewChannel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChannelInput'
            examples:
              newChannel:
                $ref: '#/components/examples/NewChannel'
      responses:
        '201':
          $ref: '#/components/responses/SuccessPostOneChannel'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'

  /channels/{id}:
    get:
      summary: Get channel by ID
      description: Returns a single radio channel by its ID
      tags:
        - Channels
      operationId: getOneChannel
      parameters:
        - $ref: '#/components/parameters/ChannelIdPathParam'
      responses:
        '200':
          $ref: '#/components/responses/SuccessGetOneChannel'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/ServerError'

    patch:
      summary: Update a channel
      description: Update one or more properties of a radio channel
      tags:
        - Channels
      operationId: patchOneChannel
      parameters:
        - $ref: '#/components/parameters/ChannelIdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChannelPatch'
            examples:
              channelPatch:
                $ref: '#/components/examples/ChannelPatch'
      responses:
        '200':
          $ref: '#/components/responses/SuccessPatchOneChannel'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/ServerError'

    delete:
      summary: Delete channel by ID
      description: Removes the specified radio channel
      tags:
        - Channels
      operationId: deleteOneChannel
      parameters:
        - $ref: '#/components/parameters/ChannelIdPathParam'
      responses:
        '204':
          $ref: '#/components/responses/SuccessDeleteOneChannel'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/ServerError'

  /shows:
    get:
      summary: Get all shows
      description: Returns a paginated list of all radio shows
      tags:
        - Shows
      operationId: getAllShows
      parameters:
        - $ref: '#/components/parameters/PaginationPageParam'
        - $ref: '#/components/parameters/PaginationPerPageParam'
        - $ref: '#/components/parameters/SortParam'
        - name: channel_number
          in: query
          description: Filter shows by channel number
          schema:
            type: integer
      responses:
        '200':
          $ref: '#/components/responses/SuccessGetAllShows'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'

    post:
      summary: Create a new show
      description: Creates a new radio show
      tags:
        - Shows
      operationId: postNewShow
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShowInput'
            examples:
              newShow:
                $ref: '#/components/examples/NewShow'
      responses:
        '201':
          $ref: '#/components/responses/SuccessPostOneShow'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'

  /shows/{id}:
    get:
      summary: Get show by ID
      description: Returns a single radio show by its ID
      tags:
        - Shows
      operationId: getOneShow
      parameters:
        - $ref: '#/components/parameters/ShowIdPathParam'
      responses:
        '200':
          $ref: '#/components/responses/SuccessGetOneShow'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'

    patch:
      summary: Update a show
      description: Update one or more properties of a radio show
      tags:
        - Shows
      operationId: patchOneShow
      parameters:
        - $ref: '#/components/parameters/ShowIdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShowPatch'
            examples:
              showPatch:
                $ref: '#/components/examples/ShowPatch'
      responses:
        '200':
          $ref: '#/components/responses/SuccessPatchOneShow'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/ServerError'

    delete:
      summary: Delete show by ID
      description: Removes the specified radio show
      tags:
        - Shows
      operationId: deleteOneShow
      parameters:
        - $ref: '#/components/parameters/ShowIdPathParam'
      responses:
        '204':
          $ref: '#/components/responses/SuccessDeleteOneShow'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/ServerError'

components:
  parameters:
    PaginationPageParam:
      name: _page
      in: query
      description: Page number for paginated results (zero-indexed).
      schema:
        type: integer
        minimum: 0
        default: 0
      example: 0

    PaginationPerPageParam:
      name: _perPage
      in: query
      description: Number of items per page (maximum 100).
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
      example: 20

    SortParam:
      name: _sort
      in: query
      description: Field to sort by, prefixed with `-` to indicate descending order.
      schema:
        type: string
      examples:
        ascendingByName:
          value: "name"
          summary: Sort by name ascending
        descendingByChannelNumber:
          value: "-channel_number"
          summary: Sort by channel number descending

    ChannelIdPathParam:
      name: id
      in: path
      required: true
      description: The unique `id` of the channel resource to retrieve.
      schema:
        type: integer

    ShowIdPathParam:
      name: id
      in: path
      required: true
      description: The unique `id` of the show resource to retrieve.
      schema:
        type: integer

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer

  schemas:
    Channel:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/ChannelId'
        channel_number:
          $ref: '#/components/schemas/ChannelNumber'
        name:
          $ref: '#/components/schemas/ChannelName'
        genre:
          $ref: '#/components/schemas/Genre'
        description:
          $ref: '#/components/schemas/Description'
        target_audience:
          $ref: '#/components/schemas/TargetAudience'
      required:
        - id
        - channel_number
        - name
        - genre
        - description
        - target_audience
      description: A radio channel resource

    ChannelInput:
      type: object
      properties:
        channel_number:
          $ref: '#/components/schemas/ChannelNumber'
        name:
          $ref: '#/components/schemas/ChannelName'
        genre:
          $ref: '#/components/schemas/Genre'
        description:
          $ref: '#/components/schemas/Description'
        target_audience:
          $ref: '#/components/schemas/TargetAudience'
      required:
        - channel_number
        - name
        - genre
        - description
        - target_audience
      description: Contains the data needed to create a new channel

    ChannelPatch:
      type: object
      properties:
        channel_number:
          $ref: '#/components/schemas/ChannelNumber'
        name:
          $ref: '#/components/schemas/ChannelName'
        genre:
          $ref: '#/components/schemas/Genre'
        description:
          $ref: '#/components/schemas/Description'
        target_audience:
          $ref: '#/components/schemas/TargetAudience'
      minProperties: 1
      description: Contains the data you can update for an existing channel

    Show:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/ShowId'
        show_name:
          $ref: '#/components/schemas/ShowName'
        host:
          $ref: '#/components/schemas/Host'
        air_time_PDT:
          $ref: '#/components/schemas/AirTimePDT'
        day_of_week:
          $ref: '#/components/schemas/DayOfWeek'
        duration_mins:
          $ref: '#/components/schemas/DurationMins'
        channel_number:
          $ref: '#/components/schemas/ChannelNumber'
      required:
        - id
        - channel_number
      description: A radio show resource

    ShowInput:
      type: object
      properties:
        show_name:
          $ref: '#/components/schemas/ShowName'
        host:
          $ref: '#/components/schemas/Host'
        air_time_PDT:
          $ref: '#/components/schemas/AirTimePDT'
        day_of_week:
          $ref: '#/components/schemas/DayOfWeek'
        duration_mins:
          $ref: '#/components/schemas/DurationMins'
        channel_number:
          $ref: '#/components/schemas/ChannelNumber'
      required:
        - channel_number
      description: Contains the data needed to create a new show

    ShowPatch:
      type: object
      properties:
        show_name:
          $ref: '#/components/schemas/ShowName'
        host:
          $ref: '#/components/schemas/Host'
        air_time_PDT:
          $ref: '#/components/schemas/AirTimePDT'
        day_of_week:
          $ref: '#/components/schemas/DayOfWeek'
        duration_mins:
          $ref: '#/components/schemas/DurationMins'
        channel_number:
          $ref: '#/components/schemas/ChannelNumber'
      minProperties: 1
      description: Contains the data you can update for an existing show

    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          $ref: '#/components/schemas/ErrorCode'
        message:
          $ref: '#/components/schemas/ErrorMessage'
        details:
          type: array
          description: Additional error details when available.
          items:
            type: object
            properties:
              field:
                type: string
                description: The field that caused the error.
              reason:
                type: string
                description: Specific reason for the error.
              location:
                type: string
                description: Where the error occurred (query, path, body).
        requestId:
          $ref: '#/components/schemas/RequestId'
      description: Describes the structure of an error response

    ChannelId:
      description: The unique ID of the channel
      type: integer
      minimum: 1

    ShowId:
      description: The unique ID of the show
      type: integer
      minimum: 1

    ChannelNumber:
      description: The channel number for the radio station
      type: integer
      minimum: 1
      maximum: 999

    ChannelName:
      description: The name of the radio channel
      type: string
      minLength: 1
      maxLength: 200

    Genre:
      description: The genre or category of music/content
      type: string
      minLength: 1
      maxLength: 200

    Description:
      description: A description of the channel or show
      type: string
      minLength: 1
      maxLength: 1000

    TargetAudience:
      description: The target audience for the channel
      type: string
      minLength: 1
      maxLength: 500

    ShowName:
      description: The name of the radio show
      type: string
      minLength: 1
      maxLength: 200

    Host:
      description: The host or DJ of the show
      type: string
      minLength: 1
      maxLength: 200

    AirTimePDT:
      description: "The air time in Pacific Daylight Time (format: HH:MM)"
      type: string
      pattern: '^([0-1][0-9]|2[0-3]):[0-5][0-9]$'
      example: "14:00"

    DayOfWeek:
      description: The days of the week when the show airs
      type: string
      minLength: 1
      maxLength: 200

    DurationMins:
      description: The duration of the show in minutes
      type: integer
      minimum: 1
      maximum: 1440

    ErrorCode:
      type: string
      description: Error code that identifies the type of error.
      examples:
        - value: "INVALID_FIELD"
        - value: "MISSING_REQUIRED_FIELD"
        - value: "RESOURCE_NOT_FOUND"

    ErrorMessage:
      type: string
      description: Human-readable error message.
      examples:
        - value: "The field `name` must be valid."
        - value: "The `name` field is required."

    RequestId:
      type: string
      description: Request identifier for troubleshooting.
      examples:
        - value: "req-f8d31a62-e789-4856-9452-5efa50223c7a"

  responses:
    SuccessGetAllChannels:
      description: Successful response that returns a list of channels.
      content:
        application/json:
          schema:
            type: object
            properties:
              items:
                type: array
                items:
                  $ref: '#/components/schemas/Channel'
          examples:
            channelsList:
              $ref: '#/components/examples/ChannelsList'

    SuccessGetOneChannel:
      description: Successful response that returns a single channel.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Channel'
          examples:
            singleChannel:
              $ref: '#/components/examples/SingleChannel'

    SuccessPostOneChannel:
      description: Successful response that returns the newly created channel.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Channel'
          examples:
            createdChannel:
              $ref: '#/components/examples/CreatedChannel'

    SuccessPatchOneChannel:
      description: Successful response that returns the updated channel.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Channel'
          examples:
            updatedChannel:
              $ref: '#/components/examples/UpdatedChannel'

    SuccessDeleteOneChannel:
      description: Confirms successful channel deletion. Returns no content.

    SuccessGetAllShows:
      description: Successful response that returns a list of shows.
      content:
        application/json:
          schema:
            type: object
            properties:
              items:
                type: array
                items:
                  $ref: '#/components/schemas/Show'
          examples:
            showsList:
              $ref: '#/components/examples/ShowsList'

    SuccessGetOneShow:
      description: Successful response that returns a single show.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Show'
          examples:
            singleShow:
              $ref: '#/components/examples/SingleShow'

    SuccessPostOneShow:
      description: Successful response that returns the newly created show.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Show'
          examples:
            createdShow:
              $ref: '#/components/examples/CreatedShow'

    SuccessPatchOneShow:
      description: Successful response that returns the updated show.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Show'
          examples:
            updatedShow:
              $ref: '#/components/examples/UpdatedShow'

    SuccessDeleteOneShow:
      description: Confirms successful show deletion. Returns no content.

    BadRequest:
      description: The request was malformed or contains invalid parameters.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          examples:
            invalidParameter:
              summary: Invalid parameter
              value:
                code: "INVALID_FIELD"
                message: "The field `name` must be valid"
                details:
                  - field: "name"
                    reason: "Invalid format"
                    location: "body"
                requestId: "req-f8d31a62-e789-4856-9452-5efa50223c7a"

    Unauthorized:
      description: Authentication is required or the provided credentials are invalid.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "UNAUTHORIZED"
            message: "Authentication is required to access this resource"
            requestId: "req-f8d31a62-e789-4856-9452-5efa50223c7a"

    Forbidden:
      description: The authenticated user does not have permission to access the requested resource.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "FORBIDDEN"
            message: "You do not have permission to access this resource"
            requestId: "req-f8d31a62-e789-4856-9452-5efa50223c7a"

    NotFound:
      description: The requested resource was not found.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "RESOURCE_NOT_FOUND"
            message: "The requested resource could not be found"
            requestId: "req-f8d31a62-e789-4856-9452-5efa50223c7a"

    TooManyRequests:
      description: The client has sent too many requests in a given amount of time.
      headers:
        Retry-After:
          schema:
            type: integer
          description: Number of seconds to wait before making a new request.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "RATE_LIMIT_EXCEEDED"
            message: "Rate limit exceeded. Try again in 30 seconds"
            requestId: "req-f8d31a62-e789-4856-9452-5efa50223c7a"

    ServerError:
      description: An unexpected server error occurred.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            code: "SERVER_ERROR"
            message: "An unexpected error occurred. Please try again later"
            requestId: "req-f8d31a62-e789-4856-9452-5efa50223c7a"

  examples:
    ChannelsList:
      summary: List of channels
      value:
        items:
          - id: 1
            channel_number: 8
            name: "80s on 8"
            genre: "1980s"
            description: "Pop hits from the 1980s MTV era"
            target_audience: "Baby boomers, Gen X, Millennials"
          - id: 2
            channel_number: 34
            name: "Lithium"
            genre: "Grunge rock, 90s alternative"
            description: "Grunge and 90s alternative rock"
            target_audience: "Grunge fans, 90s rock fans, Gen X, Millennials"
          - id: 3
            channel_number: 26
            name: "Classic Vinyl"
            genre: "1960s, 1970s"
            description: "60s/70s classic rock"
            target_audience: "Baby boomers, Gen X, Millennials"
          - id: 4
            channel_number: 2
            name: "Hits 1"
            genre: "Pop"
            description: "Pop hits, now to next"
            target_audience: "Gen X, Millennials, Gen Z, Gen alpha"

    NewChannel:
      summary: Example of new channel data
      value:
        channel_number: 8
        name: "80s on 8"
        genre: "1980s"
        description: "Pop hits from the 1980s MTV era"
        target_audience: "Baby boomers, Gen X, Millennials"

    CreatedChannel:
      summary: Example of newly created channel
      value:
        id: 1
        channel_number: 8
        name: "80s on 8"
        genre: "1980s"
        description: "Pop hits from the 1980s MTV era"
        target_audience: "Baby boomers, Gen X, Millennials"

    SingleChannel:
      summary: Example of a single channel
      value:
        id: 1
        channel_number: 8
        name: "80s on 8"
        genre: "1980s"
        description: "Pop hits from the 1980s MTV era"
        target_audience: "Baby boomers, Gen X, Millennials"

    ChannelPatch:
      summary: Example of channel patch data
      value:
        name: "Updated Channel Name"
        description: "Updated description"

    UpdatedChannel:
      summary: Example of updated channel
      value:
        id: 1
        channel_number: 8
        name: "Updated Channel Name"
        genre: "1980s"
        description: "Updated description"
        target_audience: "Baby boomers, Gen X, Millennials"

    ShowsList:
      summary: List of shows
      value:
        items:
          - id: 1
            show_name: "80s on 8 with Alan Hunter"
            host: "Alan Hunter"
            air_time_PDT: "04:00"
            day_of_week: "Monday, Tuesday, Wednesday, Thursday, Friday"
            duration_mins: 360
            channel_number: 8
          - id: 2
            show_name: "80s on 8 with Mark Goodman"
            host: "Mark Goodman"
            air_time_PDT: "13:00"
            day_of_week: "Monday, Tuesday, Wednesday, Thursday, Friday"
            duration_mins: 360
            channel_number: 8
          - id: 3
            show_name: "Madison On Lithium"
            host: "Madison"
            air_time_PDT: "03:00"
            day_of_week: "Monday, Wednesday, Thursday, Friday"
            duration_mins: 300
            channel_number: 34
          - id: 4
            show_name: "Kat Corbett On Lithium"
            host: "Kat Corbett"
            air_time_PDT: "15:00"
            day_of_week: "Monday, Tuesday, Thursday, Sunday"
            duration_mins: 360
            channel_number: 34

    NewShow:
      summary: Example of new show data
      value:
        show_name: "80s on 8 with Alan Hunter"
        host: "Alan Hunter"
        air_time_PDT: "04:00"
        day_of_week: "Monday, Tuesday, Wednesday, Thursday, Friday"
        duration_mins: 360
        channel_number: 8

    CreatedShow:
      summary: Example of newly created show
      value:
        id: 1
        show_name: "80s on 8 with Alan Hunter"
        host: "Alan Hunter"
        air_time_PDT: "04:00"
        day_of_week: "Monday, Tuesday, Wednesday, Thursday, Friday"
        duration_mins: 360
        channel_number: 8

    SingleShow:
      summary: Example of a single show
      value:
        id: 1
        show_name: "80s on 8 with Alan Hunter"
        host: "Alan Hunter"
        air_time_PDT: "04:00"
        day_of_week: "Monday, Tuesday, Wednesday, Thursday, Friday"
        duration_mins: 360
        channel_number: 8

    ShowPatch:
      summary: Example of show patch data
      value:
        show_name: "Updated Show Name"
        duration_mins: 120

    UpdatedShow:
      summary: Example of updated show
      value:
        id: 1
        show_name: "Updated Show Name"
        host: "Alan Hunter"
        air_time_PDT: "04:00"
        day_of_week: "Monday, Tuesday, Wednesday, Thursday, Friday"
        duration_mins: 120
        channel_number: 8
